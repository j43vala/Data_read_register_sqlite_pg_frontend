"use strict";(self.webpackChunkstarter_bt5=self.webpackChunkstarter_bt5||[]).push([[769],{8769:(e,t,a)=>{a.d(t,{Z:()=>C});var s=a(2791),n=a(9658),o=a(1889),r=a(4294),i=a(5527),l=a(890),d=a(8096),c=a(4925),u=a(3926),p=a(9891),m=a(5289),x=a(5661),h=a(9157),v=a(7391),g=a(7123),j=a(3400),y=a(8820),b=a(5397),Z=a(8087),f=a(5370),_=a(184);const C=()=>{var e,t,a,C,S,k,T,w,P;const[B,N]=(0,s.useState)(null),[q,A]=(0,s.useState)(!1),[E,I]=(0,s.useState)(!1),[D,M]=(0,s.useState)([]),[R,U]=(0,s.useState)(!1),[L,F]=(0,s.useState)(!1),[O,W]=(0,s.useState)([]),[J,G]=(0,s.useState)({port:"",method:"",parity:"",baudrate:"",stopbits:"",wordLength:""}),[H,V]=(0,s.useState)(""),[z,Q]=(0,s.useState)(""),[K,X]=(0,s.useState)(""),[Y,$]=(0,s.useState)(""),[ee,te]=(0,s.useState)(""),[ae,se]=(0,s.useState)(""),[ne,oe]=(0,s.useState)(""),[re,ie]=(0,s.useState)(""),[le,de]=(0,s.useState)([]),[ce,ue]=(0,s.useState)(!1),[pe,me]=(0,s.useState)(!1),[xe]=(0,s.useState)(!1),[he,ve]=(0,s.useState)(""),[ge,je]=(0,s.useState)(""),[ye,be]=(0,s.useState)(""),[Ze,fe]=(0,s.useState)(""),[_e,Ce]=(0,s.useState)(""),[Se,ke]=(0,s.useState)(""),[Te,we]=(0,s.useState)(""),[Pe,Be]=(0,s.useState)("");if((0,s.useEffect)((()=>{setTimeout((()=>{ve(""),je(""),be(""),fe(""),Ce(""),ke(""),we(""),Be("")}),5e3)}),[he,ge,ye,Ze,_e,Se,Te,Pe]),(0,s.useEffect)((()=>{(async()=>{try{const a=await fetch("/node-parameter/"),s=await a.json();if(N(s),s.node_parameters){var e,t;const a=null===(e=s.node_parameters.find((e=>"modbus"===e.name)))||void 0===e?void 0:e.value;a&&G(a);const n=null===(t=s.node_parameters.find((e=>"mqtt"===e.name)))||void 0===t?void 0:t.value;n&&de(n.qos_options||[])}}catch(a){console.error("Error fetching data:",a)}})()}),[]),!B)return(0,_.jsx)("p",{children:"Loading..."});const Ne=null===(e=B.node_parameters.find((e=>"spb_parameter"===e.name)))||void 0===e?void 0:e.value,qe=null===(t=B.node_parameters.find((e=>"node_attributes"===e.name)))||void 0===t?void 0:t.value,Ae=null===(a=B.node_parameters.find((e=>"mqtt"===e.name)))||void 0===a?void 0:a.value,Ee=[...new Set(null===(C=B.node_parameters.find((e=>"modbus"===e.name)))||void 0===C?void 0:C.value.baudrate_options)],Ie=[...new Set(null===(S=B.node_parameters.find((e=>"modbus"===e.name)))||void 0===S?void 0:S.value.wordlength_options)],De=[...new Set(null===(k=B.node_parameters.find((e=>"modbus"===e.name)))||void 0===k?void 0:k.value.parity_options)],Me=[...new Set(null===(T=B.node_parameters.find((e=>"modbus"===e.name)))||void 0===T?void 0:T.value.stopbits_options)],Re=[...new Set(null===(w=B.node_parameters.find((e=>"modbus"===e.name)))||void 0===w?void 0:w.value.port_options)],Ue=[...new Set(null===(P=B.node_parameters.find((e=>"modbus"===e.name)))||void 0===P?void 0:P.value.method_options)],Le=()=>{A(!1),F(!1),I(!1),U(!1)},Fe=(e,t,a)=>{const s=[...O];s[e][t]=a,W(s)},Oe=()=>{W((e=>[...e,{name:"",value:""}])),M((e=>[...e,{name:"",value:""}]))},We=(e,t)=>{M((a=>{const s=[...a];return s[e]=t,s}))},Je=e=>{let{message:t}=e;return(0,_.jsx)(n.Z,{severity:"success",children:t})},Ge=e=>{let{message:t}=e;return(0,_.jsx)(n.Z,{severity:"error",children:t})};return(0,_.jsxs)(o.ZP,{container:!0,spacing:1,children:[(0,_.jsxs)(o.ZP,{item:!0,xs:6,children:[_e&&(0,_.jsx)(Je,{message:_e,onClose:()=>Ce("")}),Se&&(0,_.jsx)(Je,{message:Se,onClose:()=>ke("")}),ye&&(0,_.jsx)(Je,{message:ye,onClose:()=>be("")}),ge&&(0,_.jsx)(Je,{message:ge,onClose:()=>je("")}),Ze&&(0,_.jsx)(Je,{message:Ze,onClose:()=>fe("")}),he&&(0,_.jsx)(Je,{message:he,onClose:()=>ve("")}),Te&&(0,_.jsx)(Ge,{message:Te,onClose:()=>we("")})]}),(0,_.jsx)(o.ZP,{item:!0,xs:6,children:(0,_.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"20px"},children:[(0,_.jsx)(r.Z,{onClick:()=>{ue(!0),fetch("/service/restart-services",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>{e.ok?Ce("Service is restarting."):we("Failed to restart service: ".concat(e.statusText))})).catch((e=>{we("Error restarting service: ".concat(e))})).finally((()=>{ue(!1)}))},disabled:ce||xe,variant:"contained",style:{backgroundColor:"rgb(34, 153, 84)"},children:"Restart"}),(0,_.jsx)(r.Z,{onClick:()=>{me(!0),fetch("/service/stop-services",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>{e.ok?ke("Service is stopped."):we("Failed to stop service: ".concat(e.statusText))})).catch((e=>{we("Error stopping service: ".concat(e))})).finally((()=>{me(!1)}))},disabled:pe,style:{marginLeft:"10px"},variant:"contained",color:"error",children:"Stop"})]})}),(0,_.jsx)(o.ZP,{item:!0,xs:8,children:(0,_.jsxs)(i.Z,{style:{padding:"20px",marginBottom:"20px"},children:[(0,_.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,_.jsx)(l.Z,{variant:"h6",children:"Node Attributes"}),(0,_.jsx)("div",{style:{display:"flex",gap:"0px"},children:(0,_.jsx)(j.Z,{variant:"outlined",style:{marginRight:"0px"},onClick:()=>{const e=(null===qe||void 0===qe?void 0:qe.map((e=>({name:e.name,value:e.value}))))||[];M(e),V((null===Ne||void 0===Ne?void 0:Ne.edge_node_id)||""),Q((null===Ne||void 0===Ne?void 0:Ne.group_id)||""),I(!0)},children:(0,_.jsx)(y.Z,{style:{fontSize:"medium"}})})})]}),(0,_.jsxs)("div",{style:{marginTop:"3px",display:"flex",flexDirection:"row",flexWrap:"wrap"},children:[(0,_.jsxs)("div",{style:{marginRight:"20px"},children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("strong",{children:"Group Id:"})," ",null===Ne||void 0===Ne?void 0:Ne.group_id]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("strong",{children:"Node Id:"})," ",null===Ne||void 0===Ne?void 0:Ne.edge_node_id]}),qe&&qe.slice(0,2).map(((e,t)=>(0,_.jsx)("div",{children:(0,_.jsxs)(l.Z,{variant:"body1",children:[(0,_.jsxs)("strong",{children:[e.name,":"]})," ",e.value]})},e.name)))]}),(0,_.jsx)("div",{style:{marginLeft:"30px",display:"flex",flexDirection:"column"},children:qe&&qe.slice(2).map(((e,t)=>(0,_.jsx)("div",{children:(0,_.jsxs)(l.Z,{variant:"body1",children:[(0,_.jsxs)("strong",{children:[e.name,":"]})," ",e.value]})},e.name)))})]})]})}),(0,_.jsx)(o.ZP,{item:!0,xs:4,children:(0,_.jsxs)(i.Z,{style:{padding:"20px",marginBottom:"20px"},children:[(0,_.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,_.jsx)(l.Z,{variant:"h6",children:"MQTT"}),(0,_.jsx)(j.Z,{variant:"outlined",style:{marginLeft:"10px"},onClick:()=>{$((null===Ae||void 0===Ae?void 0:Ae.broker_host)||""),te((null===Ae||void 0===Ae?void 0:Ae.broker_port)||""),ie((null===Ae||void 0===Ae?void 0:Ae.qos)||""),se((null===Ae||void 0===Ae?void 0:Ae.user)||""),oe((null===Ae||void 0===Ae?void 0:Ae.password)||""),U(!0),de((null===Ae||void 0===Ae?void 0:Ae.qos_options)||[])},children:(0,_.jsx)(y.Z,{style:{fontSize:"medium"}})})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("strong",{children:"Broker Host:"})," ",null===Ae||void 0===Ae?void 0:Ae.broker_host]}),(0,_.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,_.jsxs)("div",{style:{marginRight:"60px"},children:[(0,_.jsx)("strong",{children:"Broker Port:"})," ",null===Ae||void 0===Ae?void 0:Ae.broker_port]})}),(0,_.jsxs)("div",{children:[(0,_.jsx)("strong",{children:"Client ID:"})," ",null===Ae||void 0===Ae?void 0:Ae.user]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("strong",{children:"Client Password:"})," ",null===Ae||void 0===Ae?void 0:Ae.password]})]})}),(0,_.jsx)(o.ZP,{item:!0,xs:12,children:(0,_.jsxs)(i.Z,{style:{padding:"20px",marginBottom:"20px"},children:[(0,_.jsx)(l.Z,{variant:"h6",children:"Modbus Parameters"}),(0,_.jsx)("div",{style:{display:"flex",flexDirection:"row",marginTop:"10px"},children:["Port","Method","Parity","Baudrate","Stopbits","WordLength"].map(((e,t)=>(0,_.jsx)("div",{style:{marginRight:"20px",width:"Method"===e?"150px":"120px"},children:(0,_.jsxs)(d.Z,{fullWidth:!0,children:[(0,_.jsx)(c.Z,{children:e}),(0,_.jsxs)(u.Z,{value:J[e.toLowerCase()],onChange:t=>(async(e,t)=>{try{const a=await fetch("/node-parameter/1",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({modbus:{...J,[e]:t}})});a.ok?(ve("Modbus updated successfully."),G((a=>({...a,[e]:t})))):we("Failed to update Modbus: ".concat(a.statusText))}catch(a){we("Error updating Modbus: ".concat(a))}})(e.toLowerCase(),t.target.value),children:["Baudrate"===e&&Ee.map((e=>(0,_.jsx)(p.Z,{value:e,children:e},e))),"WordLength"===e&&Ie.map((e=>(0,_.jsx)(p.Z,{value:e,children:e},e))),"Parity"===e&&De.map((e=>(0,_.jsx)(p.Z,{value:e,children:e},e))),"Stopbits"===e&&Me.map((e=>(0,_.jsx)(p.Z,{value:e,children:e},e))),"Port"===e&&Re.map((e=>(0,_.jsx)(p.Z,{value:e,children:e},e))),"Method"===e&&Ue.map((e=>(0,_.jsx)(p.Z,{value:e,children:e},e)))]})]})},t)))})]})}),(0,_.jsxs)(m.Z,{open:q,onClose:Le,children:[(0,_.jsx)(x.Z,{children:"Update SPB Parameter"}),(0,_.jsxs)(h.Z,{children:[(0,_.jsx)(v.Z,{label:"Edge Node ID",value:H,onChange:e=>V(e.target.value),fullWidth:!0,style:{marginBottom:"16px",marginTop:"5px"}}),(0,_.jsx)(v.Z,{label:"Group ID",value:z,onChange:e=>Q(e.target.value),fullWidth:!0,style:{marginBottom:"16px",marginTop:"5px"}}),(0,_.jsx)(v.Z,{label:"Host Name",value:K,onChange:e=>X(e.target.value),fullWidth:!0})]}),(0,_.jsxs)(g.Z,{children:[(0,_.jsx)(r.Z,{onClick:Le,children:"Cancel"}),(0,_.jsx)(r.Z,{onClick:async()=>{const e={spb_parameter:{edge_node_id:H,group_id:z,hostname:K}};try{const t=await fetch("/node-parameter/3",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});t.ok?N((e=>({...e,node_parameters:e.node_parameters.map((e=>"spb_parameter"===e.name?{...e,value:{edge_node_id:H,group_id:z,hostname:K}}:e))}))):we("Failed to update SPB Parameter: ".concat(t.statusText))}catch(t){we("Error updating SPB Parameter: ".concat(t))}Le()},color:"primary",children:"Update"})]})]}),(0,_.jsxs)(m.Z,{open:E,onClose:Le,children:[(0,_.jsx)(x.Z,{children:"Edit Node Attribute"}),(0,_.jsxs)(h.Z,{children:[(0,_.jsxs)("div",{style:{display:"flex",flexDirection:"row",marginBottom:"3px"},children:[(0,_.jsx)(v.Z,{label:"Attribute Name",value:"Group ID",style:{marginRight:"10px",marginTop:"10px"}}),(0,_.jsx)(v.Z,{label:"Attribute Value",value:z,onChange:e=>Q(e.target.value),style:{marginTop:"10px"}})]}),(0,_.jsxs)("div",{style:{display:"flex",flexDirection:"row",marginBottom:"10px"},children:[(0,_.jsx)(v.Z,{label:"Attribute Name",value:"Node ID",style:{marginRight:"10px",marginTop:"10px"}}),(0,_.jsx)(v.Z,{label:"Attribute Value",value:H,onChange:e=>V(e.target.value),style:{marginTop:"10px"}})]}),D.map(((e,t)=>(0,_.jsxs)("div",{style:{display:"flex",flexDirection:"row",marginBottom:"10px"},children:[(0,_.jsx)(v.Z,{label:"Attribute Name",value:e.name,onChange:a=>We(t,{...e,name:a.target.value}),style:{marginRight:"10px"}}),(0,_.jsx)(v.Z,{label:"Attribute Value",value:e.value,onChange:a=>We(t,{...e,value:a.target.value})}),(0,_.jsx)(j.Z,{onClick:()=>(e=>{const t=[...D];t.splice(e,1),M(t)})(t),children:(0,_.jsx)(b.Z,{style:{color:"black",fontSize:"medium"}})})]},t)))]}),(0,_.jsxs)(g.Z,{children:[(0,_.jsx)(o.ZP,{item:!0,xs:2,children:(0,_.jsx)(j.Z,{onClick:Oe,children:(0,_.jsx)(Z.Z,{style:{color:"green"}})})}),(0,_.jsx)(r.Z,{onClick:Le,children:"Cancel"}),(0,_.jsx)(r.Z,{onClick:async()=>{const e={spb_parameter:{edge_node_id:H,group_id:z,hostname:K}},t={node_attributes:D.map((e=>({name:e.name,value:e.value})))};try{const a=await fetch("/node-parameter/3",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});a.ok?N((e=>({...e,node_parameters:e.node_parameters.map((e=>"spb_parameter"===e.name?{...e,value:{edge_node_id:H,group_id:z,hostname:K}}:e))}))):we("Failed to update SPB Parameter: ".concat(a.statusText));const s=await fetch("/node-parameter/4",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});s.ok?(be("Node Attribute updated successfully."),N((e=>{const t=e.node_parameters.map((e=>"node_attributes"===e.name?{...e,value:D.map((e=>({name:e.name,value:e.value})))}:e));return{...e,node_parameters:t}}))):we("Failed to update Node Attribute: ".concat(s.statusText))}catch(a){we("Error updating parameters: ".concat(a))}Le()},color:"primary",children:"Update"})]})]}),(0,_.jsxs)(m.Z,{open:L,onClose:Le,children:[(0,_.jsx)(x.Z,{children:"Add Node Attribute"}),(0,_.jsx)(h.Z,{children:O.map(((e,t)=>(0,_.jsxs)(o.ZP,{container:!0,spacing:2,alignItems:"center",style:{marginBottom:"8px"},children:[(0,_.jsx)(o.ZP,{item:!0,xs:4,children:(0,_.jsx)(v.Z,{label:"Attribute Name",value:e.name,style:{marginTop:"5px"},onChange:e=>Fe(t,"name",e.target.value)})}),(0,_.jsx)(o.ZP,{item:!0,xs:4,children:(0,_.jsx)(v.Z,{label:"Attribute Value",value:e.value,style:{marginTop:"5px"},onChange:e=>Fe(t,"value",e.target.value)})}),(0,_.jsx)(o.ZP,{item:!0,xs:2,children:t>0&&(0,_.jsx)(j.Z,{onClick:()=>{return e=t,void W((t=>t.filter(((t,a)=>a!==e))));var e},children:(0,_.jsx)(f.Z,{style:{color:"red"}})})}),(0,_.jsx)(o.ZP,{item:!0,xs:2,children:t===O.length-1&&(0,_.jsx)(j.Z,{onClick:Oe,children:(0,_.jsx)(Z.Z,{style:{color:"green"}})})})]},t)))}),(0,_.jsxs)(g.Z,{children:[(0,_.jsx)(r.Z,{onClick:Le,children:"Cancel"}),(0,_.jsx)(r.Z,{onClick:async()=>{try{const e=O.map((e=>({name:e.name,value:e.value}))),t=await fetch("/node-parameter/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"node_attributes",value:e})});t.ok?(be("Node Attributes added successfully."),N((t=>({...t,node_parameters:t.node_parameters.map((t=>"node_attributes"===t.name?{...t,value:[...t.value||[],...e]}:t))}))),W([])):we("Failed to add Node Attributes: ".concat(t.statusText))}catch(e){we("Error adding Node Attributes: ".concat(e))}Le()},color:"primary",children:"Add"})]})]}),(0,_.jsxs)(m.Z,{open:R,onClose:Le,children:[(0,_.jsx)(x.Z,{children:"Update Mqtt"}),Te&&(0,_.jsx)(Ge,{message:Te,onClose:()=>we("")}),(0,_.jsxs)(h.Z,{children:[(0,_.jsx)(v.Z,{label:"Broker Host",value:Y,onChange:e=>$(e.target.value),style:{marginBottom:"16px",marginTop:"5px",marginRight:"10px"}}),(0,_.jsx)(v.Z,{label:"Broker Port",value:ee,style:{marginBottom:"16px",marginTop:"5px"},onChange:e=>te(e.target.value)}),(0,_.jsx)(v.Z,{label:"Client ID",value:ae,onChange:e=>se(e.target.value),style:{marginBottom:"16px",marginRight:"10px"}}),(0,_.jsx)(v.Z,{label:"Client Password",value:ne,onChange:e=>oe(e.target.value)})]}),(0,_.jsxs)(g.Z,{children:[(0,_.jsx)(r.Z,{onClick:Le,children:"Cancel"}),(0,_.jsx)(r.Z,{onClick:async()=>{if(!Y)return we("Broker Host is Required"),void U(!0);if(!ee||isNaN(parseInt(ee)))return we("Broker Port is Required and must be an integer"),void U(!0);const e=parseInt(ee,10),t={mqtt:{broker_host:Y,broker_port:e,user:ae,password:ne,qos:re,qos_options:le}};try{const e=await fetch("/node-parameter/2",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(e.ok){const t=await e.json();fe("Mqtt updated successfully"),N((e=>({...e,node_parameters:e.node_parameters.map((e=>"mqtt"===e.name?{...e,value:{broker_host:Y,broker_port:ee,user:ae,password:ne,qos:re,qos_options:t.qos_options||[]}}:e))}))),de(t.qos_options||[])}else we("Failed to update Mqtt: ".concat(e.statusText))}catch(a){we("Error updating Mqtt: ".concat(a))}Le()},color:"primary",children:"Update"})]})]})]})}}}]);
//# sourceMappingURL=769.4af28e4d.chunk.js.map